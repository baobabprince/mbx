---
title: "Volcano ðŸŒ‹"
author: "Rotem & Nina"
format: html
---

```{r}
library(tidyverse)
library(ggrepel)
```


```{r}
all_results <- "Serum_maaslin_#1_allDx2/all_results.tsv" |> read_tsv()

all_results <- all_results|> 
    mutate(interst = ifelse(qval < .1, 2,ifelse(qval < .25,1,NA))) |>
    filter(metadata == "Dx") |>
    mutate(feature = feature |> str_remove("_.*"))

all_results |>
    ggplot() +aes(y =-log(qval), x = coef, color = interst |> as.factor()) + 
    expand_limits(x = c(-2.5,2)) + 
    geom_point(size = 4) + 
    geom_text_repel(data = all_results |>filter(interst == 2), aes(label = feature), color = "black") + 
    theme_minimal()
``` 